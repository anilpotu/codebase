# Global values shared across all sub-charts
global:
  # Docker registry prefix. Set to ECR URL e.g. "123456789.dkr.ecr.us-east-1.amazonaws.com"
  # Leave empty to use Docker Hub
  imageRegistry: ""
  namespace: grpc-enterprise
  imagePullPolicy: Always
  imagePullSecrets: []
  istio:
    enabled: true

# Istio mesh configuration (umbrella-level)
istio:
  gateway:
    apiHost: api.enterprise.example.com
    grpcHost: grpc.enterprise.example.com
    tlsCredentialName: enterprise-tls-credential
  jwtIssuer: "grpc-enterprise-v3"
  tracing:
    provider: jaeger
    samplingPercentage: 100.0
  rateLimiting:
    # Max requests per minute per pod for each service
    financial: 100
    health: 200
    social: 300
    grpc: 500

# user-grpc-service sub-chart values
user-grpc-service:
  replicaCount: 3
  image:
    repository: grpc-enterprise-v3
    tag: latest
  service:
    grpcPort: 9090
    actuatorPort: 8080
  resources:
    requests:
      cpu: 250m
      memory: 512Mi
    limits:
      cpu: "1"
      memory: 1Gi
  db:
    url: "jdbc:postgresql://postgres-service:5432/grpcdb"
    secretName: grpc-enterprise-db-secret
  pdb:
    enabled: true
    minAvailable: 2
  javaOpts: "-XX:MaxRAMPercentage=75.0 -XX:InitialRAMPercentage=50.0"

# financial-service sub-chart values
financial-service:
  replicaCount: 2
  image:
    repository: financial-service
    tag: latest
  service:
    port: 8081
  resources:
    requests:
      cpu: 250m
      memory: 512Mi
    limits:
      cpu: "1"
      memory: 1Gi
  db:
    url: "jdbc:postgresql://postgres-service:5432/financialdb"
    secretName: financial-service-db-secret
  pdb:
    enabled: true
    minAvailable: 1
  javaOpts: "-XX:MaxRAMPercentage=75.0 -XX:InitialRAMPercentage=50.0"

# health-service sub-chart values
health-service:
  replicaCount: 2
  image:
    repository: health-service
    tag: latest
  service:
    port: 8082
  resources:
    requests:
      cpu: 250m
      memory: 512Mi
    limits:
      cpu: "1"
      memory: 1Gi
  db:
    url: "jdbc:postgresql://postgres-service:5432/healthdb"
    secretName: health-service-db-secret
  pdb:
    enabled: true
    minAvailable: 1
  javaOpts: "-XX:MaxRAMPercentage=75.0 -XX:InitialRAMPercentage=50.0"

# social-service sub-chart values
social-service:
  replicaCount: 2
  image:
    repository: social-service
    tag: latest
  service:
    port: 8083
  resources:
    requests:
      cpu: 250m
      memory: 512Mi
    limits:
      cpu: "1"
      memory: 1Gi
  db:
    url: "jdbc:postgresql://postgres-service:5432/socialdb"
    secretName: social-service-db-secret
  pdb:
    enabled: true
    minAvailable: 1
  javaOpts: "-XX:MaxRAMPercentage=75.0 -XX:InitialRAMPercentage=50.0"
